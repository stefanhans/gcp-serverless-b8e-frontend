@@@@@@@@@@@@@@@@@@@@@ net.dart


import 'dart:async';
import 'dart:convert';

import 'package:flutter/foundation.dart' show kIsWeb;
import 'package:http/http.dart' as http;

import './types.dart';
// //kIsWeb documentation: https://api.flutter.dev/flutter/foundation/kIsWeb-constant.html

String url;
// String text = "";

Future<MasterData> createMasterDataResponse() async {
  // if (kIsWeb) {
  //   url =
  //       'https://cors-anywhere.herokuapp.com/ https://europe-west3-serverless-devops-play.cloudfunctions.net/get-vehicles';
  // } else {
  //   url =
  //       'https://europe-west3-serverless-devops-play.cloudfunctions.net/get-vehicles';
  // }

  // https://europe-west3-serverless-devops-play.cloudfunctions.net/get-master-data
  if (kIsWeb) {
    url =
    'https://cors-anywhere.herokuapp.com/ https://europe-west3-serverless-devops-play.cloudfunctions.net/get-master-data';
  } else {
    url =
    'https://europe-west3-serverless-devops-play.cloudfunctions.net/get-master-data';
  }

  print("net.dart url: " + url);

  final http.Response response = await http.post(
    url,
    headers: <String, String>{
      'Content-Type': 'application/json; charset=UTF-8',
    },
    body: jsonEncode(<String, String>{}),
  );

  print("net.dart body: " + response.body);

  MasterData masterData = MasterData.fromJson(json.decode(response.body));


  print("net.dart masterData.users: " + masterData.users.toString());
  print("net.dart masterData.vehicles: " + masterData.vehicles.toString());
  print("net.dart masterData.bookings: " + masterData.bookings.toString());
  print("net.dart masterData.status: " + masterData.status.toString());

  // List<Vehicle> vehicles = MasterData.fromJson(json.decode(response.body)).vehicles;


  // print("net.dart masterData.toJson(): " + masterData.toJson());


  // print("net.dart vehicles.length: " + vehicles.length.toString());
  // print("net.dart vehicles.toString: " + vehicles.toString());
  // print("net.dart vehicles[0].toJson(): " + vehicles[0].toJson());
  //
  // // for (var v in vehicles) {
  // //   print(v.toJson().toString());
  // //   print("----");
  // // }
  //
  // print("net.dart vehicles.toJson: " + vehicles[0].toJson());
  //
  //
  // print("net.dart geopoint.toJson: " + vehicles[0].GeoPoint.toJson());

  if (response.statusCode == 200) {
    return masterData;
  } else {
    return masterData;
  }
}









@@@@@@@@@@@@@@@@@@ types.dart


import 'dart:convert';

// Validate JSON https://jsonlint.com/

class MasterData {
  List<User> users;
  List<Vehicle> vehicles;
  List<Booking> bookings;

  // timestamp From;
  // timestamp To;
  String status;

  // timestamp statusTime;

  MasterData(
      {List<User> users,
        List<Vehicle> vehicles,
        List<Booking> bookings,
        // timestamp From,
        // timestamp To,
        String status //,
        // timestamp StatusTime
      }) {
    this.users = users;
    this.vehicles = vehicles;
    this.bookings = bookings;
    // this.from = from;
    // this.to = to;
    this.status = status;
    // this.statusTime = statusTime;
  }

  factory MasterData.fromJson(Map<String, dynamic> jsonMap) {
    print("types.dart MasterData.fromJson:");
    //
    //   return MasterData{
    //
    //   }
    //
    // MasterData _masterData = new MasterData();

    print("types.dart jsonMap:" + jsonMap["MasterData"]["Vehicles"].toString());
    // List<User>_users = User.fromJson(json.decode(response.body))


    List<User> _users = new List<User>();



    List<Vehicle> _vehicles = new List<Vehicle>();
    List<dynamic> _vehicleList = json.decode(jsonMap["MasterData"]["Vehicles"]);
    for (var vehicle in _vehicleList) {
      _vehicles.add(Vehicle.fromJson(vehicle));
    }


    List<Booking> _bookings = new List<Booking>();

    return MasterData(
      users: _users,
      vehicles: _vehicles,
      bookings: _bookings,
      // from: jsonMap["From"],
      // to: jsonMap["To"],
      status: jsonMap["MasterData"]["Status"],
      // statusTime: jsonMap["statusTime"],
    );
    //
    //   List<Vehicle> _vehicles = new List<Vehicle>();
    //   for (var vehicle in jsonMasterData) {
    //     _vehicles.add(Vehicle.fromJson(vehicle));
    //   }
    //
    //   return _masterData;
  }

// String toJson() {
//   String jsonVehicles = "";
//   for (var i=0; i<vehicles.length-1; i++) {
//     jsonVehicles += vehicles[i].toJson()+",";
//   }
//   jsonVehicles += vehicles[vehicles.length-1].toJson();
//   return "{\"Vehicles\":"+"["+jsonVehicles+"]}";
// }
}

class User {
  String DocId;
  String Name;
  String Type;
  String Status;
  String Description;

  User(
      {String DocId,
        String Name,
        String Type,
        String Status,
        String Description}) {
    this.DocId = DocId;
    this.Name = Name;
    this.Type = Type;
    this.Status = Status;
    this.Description = Description;
  }

  factory User.fromJson(Map<String, dynamic> jsonMap) {
    print("types.dart User.fromJson:");
    print(jsonMap.toString());

    return User(
      DocId: jsonMap["DocId"],
      Name: jsonMap["Name"],
      Type: jsonMap["Type"],
      Status: jsonMap["Status"],
      Description: jsonMap["Description"],
    );
  }

  String toJson() {
    return "{" +
        "\"DocId\": " +
        "\"" +
        this.DocId +
        "\"" +
        "," +
        "\"Name\": " +
        "\"" +
        this.Name +
        "\"" +
        "," +
        "\"Type\": " +
        "\"" +
        this.Type +
        "\"" +
        "," +
        "\"Status\": " +
        "\"" +
        this.Status +
        "\"" +
        "," +
        "\"Description\": " +
        "\"" +
        this.Description +
        "\"" +
        "}";
  }
}

class Vehicle {
  String DocId;
  String Name;
  String Type;
  String Status;
  String ParkingLot;
  Geopoint GeoPoint;
  String Description;

  Vehicle(
      {String DocId,
        String Name,
        String Type,
        String Status,
        String ParkingLot,
        Geopoint GeoPoint,
        String Description}) {
    this.DocId = DocId;
    this.Name = Name;
    this.Type = Type;
    this.Status = Status;
    this.ParkingLot = ParkingLot;
    this.GeoPoint = GeoPoint;
    this.Description = Description;
  }

  factory Vehicle.fromJson(Map<String, dynamic> jsonMap) {
    print("types.dart Vehicle.fromJson:");
    print(jsonMap.toString());

    return Vehicle(
      DocId: jsonMap["DocId"],
      Name: jsonMap["Name"],
      Type: jsonMap["Type"],
      Status: jsonMap["Status"],
      ParkingLot: jsonMap["ParkingLot"],
      GeoPoint: Geopoint.fromJson(json.decode(jsonMap["GeoPoint"]
          .toString()
          .replaceAll("latitude", "\"latitude\"")
          .replaceAll("longitude", "\"longitude\""))),
      Description: jsonMap["Description"],
    );
  }

  String toJson() {
    return "{" +
        "\"DocId\": " +
        "\"" +
        this.DocId +
        "\"" +
        "," +
        "\"Name\": " +
        "\"" +
        this.Name +
        "\"" +
        "," +
        "\"Type\": " +
        "\"" +
        this.Type +
        "\"" +
        "," +
        "\"Status\": " +
        "\"" +
        this.Status +
        "\"" +
        "," +
        "\"ParkingLot\": " +
        "\"" +
        this.ParkingLot +
        "\"" +
        "," +
        "\"Geopoint\": " +
        this.GeoPoint.toJson() +
        ",\"Description\": " +
        "\"" +
        this.Description +
        "\"" +
        "}";
  }
}

class Geopoint {
  double Latitude;
  double Longitude;

  Geopoint({double Latitude, double Longitude}) {
    this.Latitude = Latitude;
    this.Longitude = Longitude;
  }

  factory Geopoint.fromJson(Map<String, dynamic> json) {
    print("types.dart Geopoint:");
    print(json.toString());

    return Geopoint(
        Latitude: double.parse(json["latitude"].toString()),
        Longitude: double.parse(json["longitude"].toString()));
  }

  String toJson() {
    return "{" +
        "\"latitude\": " +
        this.Latitude.toString() +
        ","
            "\"longitude\": " +
        this.Longitude.toString() +
        "}";
  }
}

class Booking {
  String DocId;
  String User;
  String Vehicle;
  String VehicleType;
  String VehicleStatus;
  String ParkingLot;

  // timestamp From;
  // timestamp To;
  String Status;

  // timestamp StatusTime;

  Booking(
      {String DocId,
        String User,
        String Vehicle,
        String VehicleType,
        String VehicleStatus,
        String ParkingLot,
        // timestamp From,
        // timestamp To,
        String Status //,
        // timestamp StatusTime
      }) {
    this.DocId = DocId;
    this.User = User;
    this.Vehicle = Vehicle;
    this.VehicleType = VehicleType;
    this.VehicleStatus = VehicleStatus;
    this.ParkingLot = ParkingLot;
    // this.From = From;
    // this.To = To;
    this.Status = Status;
    // this.StatusTime = StatusTime;
  }

  // "DocId": "ZbAvWNPqKBrVCPcexz1Y",
  // "User": "Alice",
  // "Vehicle": "Tesla Deluxe",
  // "VehicleType": "eCar",
  // "VehicleStatus": "ready",
  // "ParkingLot": "Joe's Garage",
  // "From": "2020-09-19T15:05:48.212968Z",
  // "To": "2020-09-19T17:05:48.212968Z",
  // "Status": "request",
  // "StatusTime": "2020-09-19T15:05:48.212968Z"

  factory Booking.fromJson(Map<String, dynamic> jsonMap) {
    print("types.dart Booking.fromJson:");
    print(jsonMap.toString());

    return Booking(
      DocId: jsonMap["DocId"],
      User: jsonMap["User"],
      Vehicle: jsonMap["Vehicle"],
      VehicleType: jsonMap["VehicleType"],
      VehicleStatus: jsonMap["VehicleStatus"],
      ParkingLot: jsonMap["ParkingLot"],
      // From: jsonMap["From"],
      // To: jsonMap["To"],
      Status: jsonMap["Status"],
      // StatusTime: jsonMap["StatusTime"],
    );
  }

  String toJson() {
    return "{" +
        "\"DocId\": " +
        "\"" +
        this.DocId +
        "\"" +
        "," +
        "\"User\": " +
        "\"" +
        this.User +
        "\"" +
        "," +
        "\"Vehicle\": " +
        "\"" +
        this.Vehicle +
        "\"" +
        "," +
        "\"VehicleType\": " +
        "\"" +
        this.VehicleType +
        "\"" +
        "," +
        "\"VehicleStatus\": " +
        "\"" +
        this.VehicleStatus +
        "\"" +
        "," +
        "\"ParkingLot\": " +
        "\"" +
        this.ParkingLot +
        "\"" +
        // "," +
        // "\"From\": " +
        // this.From +
        // "," +
        // "\"To\": " +
        // this.To +
        "," +
        "\"Status\": " +
        this.Status +
        // ",\"StatusTime\": " +
        // "\""+this.StatusTime+"\"" +
        "}";
  }
}

